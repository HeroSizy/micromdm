from flask import Flask, request, abort
import base64
import json
import sys
import plistlib
import requests

app = Flask(__name__)

@app.route('/webhook', methods=['POST'])
def webhook():
	print(request.json)
	if 'acknowledge_event' in request.json:
		raw_payload = request.json['acknowledge_event']['raw_payload']
		payload = base64.b64decode(raw_payload).decode('utf-8')
		print(payload)
	elif 'checkin_event' in request.json:
		print("New Device was registered")
		raw_payload = request.json['checkin_event']['raw_payload']
		payload = base64.b64decode(raw_payload).decode('utf-8')
		print(payload)
		parseResponseJSON(request.json)
	return ''









def parseResponseString(request):
    response_json = json.loads(request)
    parseResponseJSON(response_json)

def parseResponseJSON(response_json):
    if 'topic' in response_json and response_json['topic'] == 'mdm.Authenticate':
        raw_payload = response_json['checkin_event']['raw_payload']
        payload_xml = base64.b64decode(raw_payload).decode('utf-8')
        
        if sys.version_info >= (3, 0):
            pl = plistlib.readPlistFromBytes(payload_xml.encode());
        else:
            pl = plistlib.readPlistFromString(payload_xml);
    
        if 'SerialNumber' in pl and 'UDID' in pl:
            serial_number = pl['SerialNumber']
            udid = pl['UDID']
            pushSettings(udid)
            restrict_apps(udid)
            vpp_associate(serial_number)
            homescreen_layout(udid)
            install_vpp_abaclock_unmanaged(udid)
            managed_application_configuration(udid)
            single_app_mode_abaclock(udid)
            profile_list(udid)
            managed_application_feedback(udid)
    else:
        print(json)

def pushSettings(udid, device_name='New AbaClocK iPad'):
    data = '{"udid":"'+udid+'","request_type":"Settings","settings":[{"item":"Bluetooth","enabled":true},{"item":"AppAnalytics","enabled":true},{"item":"DiagnosticSubmission","enabled":true},{"item":"DeviceName","device_name":"'+device_name+'"}]}'
    response = requests.post('https://tobis.jumpingcrab.com/v1/commands', data=data, auth=('micromdm', 'secret'))
    print("pushSettings", udid, response)

def vpp_associate(serial_number):
    headers = {
        'Content-Type': 'application/json',
    }
    data = '{"sToken":"eyJleHBEYXRlIjoiMjAxOS0xMS0wN1QwNjoyMTowMC0wODAwIiwidG9rZW4iOiJRd05hZnVnSk9vZ2tsbS9zZU52Y1pFdXhGYStLUThSNDNsQXJ4ajNQcVdUMmNpWG1iY0I5aW9LUmhOV3NSSFNEVGpIQ3NJcmxWYTAxcm5XYy9jMFNnZ09WakFQbzV2NnNSVWhVWmVjNHBMbCs3Q1pUcHZGZ0JvQm9mVTFiWTdJc3FWZnZta2UxWkZ4dVZzbUlRNEJtTnc9PSIsIm9yZ05hbWUiOiJBYmFjdXMgUmVzZWFyY2ggQUcifQ==", "adamIdStr": "1301278477", "pricingParam": "STDQ", "associateSerialNumbers": ["'+serial_number+'"]}'
    response = requests.post('https://vpp.itunes.apple.com/WebObjects/MZFinance.woa/wa/manageVPPLicensesByAdamIdSrv', headers=headers, data=data)
    print("vpp_associate", serial_number, response)

def install_profile(udid, payload):
    data = '{"udid":"'+udid+'","payload":"'+payload+'","request_type":"InstallProfile"}'
    response = requests.post('https://tobis.jumpingcrab.com/v1/commands', data=data, auth=('micromdm', 'secret'))
    print("install_profile", udid, response)

def restrict_apps(udid):
    install_profile(udid, "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHBsaXN0IFBVQkxJQyAiLS8vQXBwbGUvL0RURCBQTElTVCAxLjAvL0VOIiAiaHR0cDovL3d3dy5hcHBsZS5jb20vRFREcy9Qcm9wZXJ0eUxpc3QtMS4wLmR0ZCI+CjxwbGlzdCB2ZXJzaW9uPSIxLjAiPgo8ZGljdD4KCTxrZXk+UGF5bG9hZENvbnRlbnQ8L2tleT4KCTxhcnJheT4KCQk8ZGljdD4KCQkJPGtleT5QYXlsb2FkRGVzY3JpcHRpb248L2tleT4KCQkJPHN0cmluZz5Db25maWd1cmVzIHJlc3RyaWN0aW9uczwvc3RyaW5nPgoJCQk8a2V5PlBheWxvYWREaXNwbGF5TmFtZTwva2V5PgoJCQk8c3RyaW5nPlJlc3RyaWN0aW9uczwvc3RyaW5nPgoJCQk8a2V5PlBheWxvYWRJZGVudGlmaWVyPC9rZXk+CgkJCTxzdHJpbmc+Y2guYWJhY3VzLmFiYWNsb2NrLmNsaWVudDIuYXBwbGljYXRpb25hY2Nlc3MuOTg3Q0M0MDQtQkNBMy00OUIxLUEwREQtREE5MDNDQjQ1NjRDPC9zdHJpbmc+CgkJCTxrZXk+UGF5bG9hZFR5cGU8L2tleT4KCQkJPHN0cmluZz5jb20uYXBwbGUuYXBwbGljYXRpb25hY2Nlc3M8L3N0cmluZz4KCQkJPGtleT5QYXlsb2FkVVVJRDwva2V5PgoJCQk8c3RyaW5nPjk4N0NDNDA0LUJDQTMtNDlCMS1BMERELURBOTAzQ0I0NTY0Qzwvc3RyaW5nPgoJCQk8a2V5PlBheWxvYWRWZXJzaW9uPC9rZXk+CgkJCTxpbnRlZ2VyPjE8L2ludGVnZXI+CgkJCTxrZXk+YWxsb3dBY3Rpdml0eUNvbnRpbnVhdGlvbjwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dBZGRpbmdHYW1lQ2VudGVyRnJpZW5kczwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dBaXJQbGF5SW5jb21pbmdSZXF1ZXN0czwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dBaXJQcmludDwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dBaXJQcmludENyZWRlbnRpYWxzU3RvcmFnZTwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dBaXJQcmludGlCZWFjb25EaXNjb3Zlcnk8L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93QXBwQ2VsbHVsYXJEYXRhTW9kaWZpY2F0aW9uPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd0FwcEluc3RhbGxhdGlvbjwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dBcHBSZW1vdmFsPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd0Fzc2lzdGFudDwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dBc3Npc3RhbnRXaGlsZUxvY2tlZDwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dBdXRvQ29ycmVjdGlvbjwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dBdXRvbWF0aWNBcHBEb3dubG9hZHM8L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93Qmx1ZXRvb3RoTW9kaWZpY2F0aW9uPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd0Jvb2tzdG9yZTwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dCb29rc3RvcmVFcm90aWNhPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd0NhbWVyYTwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dDZWxsdWxhclBsYW5Nb2RpZmljYXRpb248L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93Q2hhdDwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dDbG91ZEJhY2t1cDwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dDbG91ZERvY3VtZW50U3luYzwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dDbG91ZFBob3RvTGlicmFyeTwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dEZWZpbml0aW9uTG9va3VwPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd0RldmljZU5hbWVNb2RpZmljYXRpb248L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93RGljdGF0aW9uPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd0VTSU1Nb2RpZmljYXRpb248L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93RW5hYmxpbmdSZXN0cmljdGlvbnM8L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93RW50ZXJwcmlzZUFwcFRydXN0PC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd0VudGVycHJpc2VCb29rQmFja3VwPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd0VudGVycHJpc2VCb29rTWV0YWRhdGFTeW5jPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd0VyYXNlQ29udGVudEFuZFNldHRpbmdzPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd0V4cGxpY2l0Q29udGVudDwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dGaW5nZXJwcmludEZvclVubG9jazwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dGaW5nZXJwcmludE1vZGlmaWNhdGlvbjwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dHYW1lQ2VudGVyPC9rZXk+CgkJCTxmYWxzZS8+CgkJCTxrZXk+YWxsb3dHbG9iYWxCYWNrZ3JvdW5kRmV0Y2hXaGVuUm9hbWluZzwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dJbkFwcFB1cmNoYXNlczwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dLZXlib2FyZFNob3J0Y3V0czwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dNYW5hZ2VkQXBwc0Nsb3VkU3luYzwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dNYW5hZ2VkVG9Xcml0ZVVubWFuYWdlZENvbnRhY3RzPC9rZXk+CgkJCTxmYWxzZS8+CgkJCTxrZXk+YWxsb3dNdWx0aXBsYXllckdhbWluZzwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dNdXNpY1NlcnZpY2U8L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93TmV3czwva2V5PgoJCQk8ZmFsc2UvPgoJCQk8a2V5PmFsbG93Tm90aWZpY2F0aW9uc01vZGlmaWNhdGlvbjwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dPcGVuRnJvbU1hbmFnZWRUb1VubWFuYWdlZDwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dPcGVuRnJvbVVubWFuYWdlZFRvTWFuYWdlZDwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dQYWlyZWRXYXRjaDwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dQYXNzYm9va1doaWxlTG9ja2VkPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd1Bhc3Njb2RlTW9kaWZpY2F0aW9uPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd1Bhc3N3b3JkQXV0b0ZpbGw8L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93UGFzc3dvcmRQcm94aW1pdHlSZXF1ZXN0czwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dQYXNzd29yZFNoYXJpbmc8L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93UGhvdG9TdHJlYW08L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93UG9kY2FzdHM8L2tleT4KCQkJPGZhbHNlLz4KCQkJPGtleT5hbGxvd1ByZWRpY3RpdmVLZXlib2FyZDwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dQcm94aW1pdHlTZXR1cFRvTmV3RGV2aWNlPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd1JhZGlvU2VydmljZTwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dSZW1vdGVBcHBQYWlyaW5nPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd1JlbW90ZVNjcmVlbk9ic2VydmF0aW9uPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd1NhZmFyaTwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dTY3JlZW5TaG90PC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd1NoYXJlZFN0cmVhbTwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dTcGVsbENoZWNrPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd1Nwb3RsaWdodEludGVybmV0UmVzdWx0czwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dTeXN0ZW1BcHBSZW1vdmFsPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd1VJQXBwSW5zdGFsbGF0aW9uPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd1VJQ29uZmlndXJhdGlvblByb2ZpbGVJbnN0YWxsYXRpb248L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93VVNCUmVzdHJpY3RlZE1vZGU8L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93VW5tYW5hZ2VkVG9SZWFkTWFuYWdlZENvbnRhY3RzPC9rZXk+CgkJCTxmYWxzZS8+CgkJCTxrZXk+YWxsb3dVbnRydXN0ZWRUTFNQcm9tcHQ8L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93VlBOQ3JlYXRpb248L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93VmlkZW9Db25mZXJlbmNpbmc8L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmFsbG93Vm9pY2VEaWFsaW5nPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5hbGxvd1dhbGxwYXBlck1vZGlmaWNhdGlvbjwva2V5PgoJCQk8dHJ1ZS8+CgkJCTxrZXk+YWxsb3dpVHVuZXM8L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PmVuZm9yY2VkU29mdHdhcmVVcGRhdGVEZWxheTwva2V5PgoJCQk8aW50ZWdlcj4zMDwvaW50ZWdlcj4KCQkJPGtleT5mb3JjZUFpckRyb3BVbm1hbmFnZWQ8L2tleT4KCQkJPGZhbHNlLz4KCQkJPGtleT5mb3JjZUFpclByaW50VHJ1c3RlZFRMU1JlcXVpcmVtZW50PC9rZXk+CgkJCTxmYWxzZS8+CgkJCTxrZXk+Zm9yY2VBc3Npc3RhbnRQcm9mYW5pdHlGaWx0ZXI8L2tleT4KCQkJPGZhbHNlLz4KCQkJPGtleT5mb3JjZUF1dGhlbnRpY2F0aW9uQmVmb3JlQXV0b0ZpbGw8L2tleT4KCQkJPGZhbHNlLz4KCQkJPGtleT5mb3JjZUF1dG9tYXRpY0RhdGVBbmRUaW1lPC9rZXk+CgkJCTxmYWxzZS8+CgkJCTxrZXk+Zm9yY2VDbGFzc3Jvb21BdXRvbWF0aWNhbGx5Sm9pbkNsYXNzZXM8L2tleT4KCQkJPGZhbHNlLz4KCQkJPGtleT5mb3JjZUNsYXNzcm9vbVJlcXVlc3RQZXJtaXNzaW9uVG9MZWF2ZUNsYXNzZXM8L2tleT4KCQkJPGZhbHNlLz4KCQkJPGtleT5mb3JjZUNsYXNzcm9vbVVucHJvbXB0ZWRBcHBBbmREZXZpY2VMb2NrPC9rZXk+CgkJCTxmYWxzZS8+CgkJCTxrZXk+Zm9yY2VDbGFzc3Jvb21VbnByb21wdGVkU2NyZWVuT2JzZXJ2YXRpb248L2tleT4KCQkJPGZhbHNlLz4KCQkJPGtleT5mb3JjZURlbGF5ZWRTb2Z0d2FyZVVwZGF0ZXM8L2tleT4KCQkJPGZhbHNlLz4KCQkJPGtleT5mb3JjZUVuY3J5cHRlZEJhY2t1cDwva2V5PgoJCQk8ZmFsc2UvPgoJCQk8a2V5PmZvcmNlSVR1bmVzU3RvcmVQYXNzd29yZEVudHJ5PC9rZXk+CgkJCTxmYWxzZS8+CgkJCTxrZXk+Zm9yY2VXYXRjaFdyaXN0RGV0ZWN0aW9uPC9rZXk+CgkJCTxmYWxzZS8+CgkJCTxrZXk+Zm9yY2VXaUZpV2hpdGVsaXN0aW5nPC9rZXk+CgkJCTxmYWxzZS8+CgkJCTxrZXk+cmF0aW5nQXBwczwva2V5PgoJCQk8aW50ZWdlcj4xMDAwPC9pbnRlZ2VyPgoJCQk8a2V5PnJhdGluZ01vdmllczwva2V5PgoJCQk8aW50ZWdlcj4xMDAwPC9pbnRlZ2VyPgoJCQk8a2V5PnJhdGluZ1JlZ2lvbjwva2V5PgoJCQk8c3RyaW5nPnVzPC9zdHJpbmc+CgkJCTxrZXk+cmF0aW5nVFZTaG93czwva2V5PgoJCQk8aW50ZWdlcj4xMDAwPC9pbnRlZ2VyPgoJCQk8a2V5PnNhZmFyaUFjY2VwdENvb2tpZXM8L2tleT4KCQkJPGludGVnZXI+MjwvaW50ZWdlcj4KCQkJPGtleT5zYWZhcmlBbGxvd0F1dG9GaWxsPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5zYWZhcmlBbGxvd0phdmFTY3JpcHQ8L2tleT4KCQkJPHRydWUvPgoJCQk8a2V5PnNhZmFyaUFsbG93UG9wdXBzPC9rZXk+CgkJCTx0cnVlLz4KCQkJPGtleT5zYWZhcmlGb3JjZUZyYXVkV2FybmluZzwva2V5PgoJCQk8ZmFsc2UvPgoJCQk8a2V5PndoaXRlbGlzdGVkQXBwQnVuZGxlSURzPC9rZXk+CgkJCTxhcnJheT4KCQkJCTxzdHJpbmc+Y2guYWJhY3VzLmFiYWNsb2NrLmNsaWVudDI8L3N0cmluZz4KCQkJCTxzdHJpbmc+Y29tLmFwcGxlLnNwcmluZ2JvYXJkPC9zdHJpbmc+CgkJCQk8c3RyaW5nPmNvbS5hcHBsZS5QcmVmZXJlbmNlczwvc3RyaW5nPgoJCQkJPHN0cmluZz5jb20uYXBwbGUubW9iaWxlc2FmYXJpPC9zdHJpbmc+CgkJCQk8c3RyaW5nPmNvbS5hcHBsZS5tb2JpbGVtYWlsPC9zdHJpbmc+CgkJCQk8c3RyaW5nPmNvbS5hcHBsZS5BcHBTdG9yZTwvc3RyaW5nPgogICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUuVGVzdEZsaWdodDwvc3RyaW5nPgoJCQk8L2FycmF5PgoJCTwvZGljdD4KCTwvYXJyYXk+Cgk8a2V5PlBheWxvYWREaXNwbGF5TmFtZTwva2V5PgoJPHN0cmluZz5VbnRpdGxlZCAyPC9zdHJpbmc+Cgk8a2V5PlBheWxvYWRJZGVudGlmaWVyPC9rZXk+Cgk8c3RyaW5nPmNoLmFiYWN1cy5hYmFjbG9jay5jbGllbnQyLmFwcGxpY2F0aW9uYWNjZXNzLjk4N0NDNDA0LUJDQTMtNDlCMS1BMERELURBOTAzQ0I0NTY0Qzwvc3RyaW5nPgoJPGtleT5QYXlsb2FkUmVtb3ZhbERpc2FsbG93ZWQ8L2tleT4KCTxmYWxzZS8+Cgk8a2V5PlBheWxvYWRUeXBlPC9rZXk+Cgk8c3RyaW5nPkNvbmZpZ3VyYXRpb248L3N0cmluZz4KCTxrZXk+UGF5bG9hZFVVSUQ8L2tleT4KCTxzdHJpbmc+NDc3Njg4NTEtMjdCOC00QjExLUEwQzUtMDY2RDVBNzU4RDA4PC9zdHJpbmc+Cgk8a2V5PlBheWxvYWRWZXJzaW9uPC9rZXk+Cgk8aW50ZWdlcj4xPC9pbnRlZ2VyPgo8L2RpY3Q+CjwvcGxpc3Q+Cg==")

def homescreen_layout(udid):
    install_profile(udid, "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHBsaXN0IFBVQkxJQyAiLS8vQXBwbGUvL0RURCBQTElTVCAxLjAvL0VOIiAiaHR0cDovL3d3dy5hcHBsZS5jb20vRFREcy9Qcm9wZXJ0eUxpc3QtMS4wLmR0ZCI+CjxwbGlzdCB2ZXJzaW9uPSIxLjAiPgogICAgPGRpY3Q+CiAgICAgICAgPGtleT5QYXlsb2FkQ29udGVudDwva2V5PgogICAgICAgIDxhcnJheT4KICAgICAgICAgICAgPGRpY3Q+CiAgICAgICAgICAgICAgICA8a2V5PkRvY2s8L2tleT4KICAgICAgICAgICAgICAgIDxhcnJheT4KICAgICAgICAgICAgICAgICAgICA8ZGljdD4KICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5UeXBlPC9rZXk+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+V2ViQ2xpcDwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlVSTDwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPmh0dHBzOi8vbW9uaXRvcmluZy5hYmFjbG9jay5jaDwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgIDwvZGljdD4KCQkJCQk8ZGljdD4KICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPmNvbS5hcHBsZS5BcHBTdG9yZTwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgIDwvZGljdD4KICAgICAgICAgICAgICAgICAgICA8ZGljdD4KICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPmNvbS5hcHBsZS5tb2JpbGVwaG9uZTwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgIDwvZGljdD4KICAgICAgICAgICAgICAgICAgICA8ZGljdD4KICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPmNvbS5hcHBsZS5tb2JpbGVtYWlsPC9zdHJpbmc+CiAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPkFwcGxpY2F0aW9uPC9zdHJpbmc+CiAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgogICAgICAgICAgICAgICAgICAgIDxkaWN0PgogICAgICAgICAgICAgICAgICAgICAgICA8a2V5PkJ1bmRsZUlEPC9rZXk+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLm1vYmlsZXNhZmFyaTwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgIDwvZGljdD4KICAgICAgICAgICAgICAgICAgICA8ZGljdD4KICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPmNvbS5hcHBsZS5QcmVmZXJlbmNlczwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgIDwvZGljdD4KICAgICAgICAgICAgICAgICAgICA8ZGljdD4KICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPmNoLmFiYWN1cy5hYmFjbG9jay5jbGllbnQyPC9zdHJpbmc+CiAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPkFwcGxpY2F0aW9uPC9zdHJpbmc+CiAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgogICAgICAgICAgICAgICAgPC9hcnJheT4KICAgICAgICAgICAgICAgIDxrZXk+UGFnZXM8L2tleT4KICAgICAgICAgICAgICAgIDxhcnJheT4KICAgICAgICAgICAgICAgICAgICA8YXJyYXk+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5EaXNwbGF5TmFtZTwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5TeXN0ZW08L3N0cmluZz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+UGFnZXM8L2tleT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhcnJheT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YXJyYXk+CgkJCQkgICAgICAgICAgICAgICAgICAgIDxkaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUuTW9iaWxlU01TPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLm1vYmlsZXNsaWRlc2hvdzwvc3RyaW5nPgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5UeXBlPC9rZXk+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPkFwcGxpY2F0aW9uPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgIDwvZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPGRpY3Q+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PkJ1bmRsZUlEPC9rZXk+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPmNvbS5hcHBsZS5yZW1pbmRlcnM8L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUuY2FtZXJhPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLm1vYmlsZXRpbWVyPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLlBhc3Nib29rPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLndlYXRoZXI8L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgoJCQkJICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgoJCQkJICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUubW9iaWxlY2FsPC9zdHJpbmc+CgkJCQkgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJCSAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KCQkJCSAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLk1hcHM8L3N0cmluZz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hcnJheT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YXJyYXk+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUubW9iaWxlbWUuZm1pcDE8L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUubW9iaWxlbWUuZm1mMTwvc3RyaW5nPgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5UeXBlPC9rZXk+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPkFwcGxpY2F0aW9uPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgIDwvZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPGRpY3Q+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PkJ1bmRsZUlEPC9rZXk+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPmNvbS5hcHBsZS5pQm9va3M8L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUuRG9jdW1lbnRzQXBwPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLkhvbWU8L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUuUGhvdG8tQm9vdGg8L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hcnJheT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YXJyYXk+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUuZmFjZXRpbWU8L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUuSGVhbHRoPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLk1vYmlsZVN0b3JlPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLk11c2ljPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLnBvZGNhc3RzPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLmdhbWVjZW50ZXI8L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUuQnJpZGdlPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgoJCQkgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLnZpZGVvczwvc3RyaW5nPgoJCQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5UeXBlPC9rZXk+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPkFwcGxpY2F0aW9uPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgIDwvZGljdD4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPGRpY3Q+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PkJ1bmRsZUlEPC9rZXk+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPmNvbS5hcHBsZS50aXBzPC9zdHJpbmc+CgkJCSAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KCQkJICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYXJyYXk+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGFycmF5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLmNhbGN1bGF0b3I8L3N0cmluZz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUuTW9iaWxlQWRkcmVzc0Jvb2s8L3N0cmluZz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUubW9iaWxlbm90ZXM8L3N0cmluZz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUuc3RvY2tzPC9zdHJpbmc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2V5PlR5cGU8L2tleT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+QXBwbGljYXRpb248L3N0cmluZz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGljdD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+QnVuZGxlSUQ8L2tleT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLlZvaWNlTWVtb3M8L3N0cmluZz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5BcHBsaWNhdGlvbjwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RpY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaWN0PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5CdW5kbGVJRDwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5jb20uYXBwbGUuY29tcGFzczwvc3RyaW5nPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtleT5UeXBlPC9rZXk+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3RyaW5nPkFwcGxpY2F0aW9uPC9zdHJpbmc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGljdD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2FycmF5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9hcnJheT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxrZXk+VHlwZTwva2V5PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN0cmluZz5Gb2xkZXI8L3N0cmluZz4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaWN0PgogICAgICAgICAgICAgICAgICAgIDwvYXJyYXk+CiAgICAgICAgICAgICAgICA8L2FycmF5PgogICAgICAgICAgICAgICAgPGtleT5QYXlsb2FkRGlzcGxheU5hbWU8L2tleT4KICAgICAgICAgICAgICAgIDxzdHJpbmc+SG9tZXNjcmVlbiBMYXlvdXQ8L3N0cmluZz4KICAgICAgICAgICAgICAgIDxrZXk+UGF5bG9hZElkZW50aWZpZXI8L2tleT4KICAgICAgICAgICAgICAgIDxzdHJpbmc+Y2guYWJhY3VzLmFiYWNsb2NrLmNsaWVudDIuaG9tZXNjcmVlbmxheW91dC4zOUMzOTVFNy1EREIwLTQ2RTQtQjk4RS05MjNERTAxNUE5Qzk8L3N0cmluZz4KICAgICAgICAgICAgICAgIDxrZXk+UGF5bG9hZFR5cGU8L2tleT4KICAgICAgICAgICAgICAgIDxzdHJpbmc+Y29tLmFwcGxlLmhvbWVzY3JlZW5sYXlvdXQ8L3N0cmluZz4KICAgICAgICAgICAgICAgIDxrZXk+UGF5bG9hZFVVSUQ8L2tleT4KICAgICAgICAgICAgICAgIDxzdHJpbmc+MzlDMzk1RTctRERCMC00NkU0LUI5OEUtOTIzREUwMTVBOUM5PC9zdHJpbmc+CiAgICAgICAgICAgICAgICA8a2V5PlBheWxvYWRWZXJzaW9uPC9rZXk+CiAgICAgICAgICAgICAgICA8aW50ZWdlcj4xPC9pbnRlZ2VyPgogICAgICAgICAgICA8L2RpY3Q+CiAgICAgICAgPC9hcnJheT4KICAgICAgICA8a2V5PlBheWxvYWREaXNwbGF5TmFtZTwva2V5PgogICAgICAgIDxzdHJpbmc+SG9tZXNjcmVlbi1MYXlvdXQtS29uZmlndXJhdGlvbjwvc3RyaW5nPgogICAgICAgIDxrZXk+UGF5bG9hZElkZW50aWZpZXI8L2tleT4KICAgICAgICA8c3RyaW5nPmNoLmFiYWN1cy5hYmFjbG9jay5jbGllbnQyLmhvbWVzY3JlZW5sYXlvdXQuMzlDMzk1RTctRERCMC00NkU0LUI5OEUtOTIzREUwMTVBOUM5PC9zdHJpbmc+CiAgICAgICAgPGtleT5QYXlsb2FkUmVtb3ZhbERpc2FsbG93ZWQ8L2tleT4KICAgICAgICA8ZmFsc2UvPgogICAgICAgIDxrZXk+UGF5bG9hZFR5cGU8L2tleT4KICAgICAgICA8c3RyaW5nPkNvbmZpZ3VyYXRpb248L3N0cmluZz4KICAgICAgICA8a2V5PlBheWxvYWRVVUlEPC9rZXk+CiAgICAgICAgPHN0cmluZz43RTg5QjUxNC01MzkyLTQ1QUMtQjE0Ni0wQzMyMDIzNkY0MjE8L3N0cmluZz4KICAgICAgICA8a2V5PlBheWxvYWRWZXJzaW9uPC9rZXk+CiAgICAgICAgPGludGVnZXI+MTwvaW50ZWdlcj4KICAgIDwvZGljdD4KPC9wbGlzdD4K")

def single_app_mode_abaclock(udid):
    install_profile(udid, "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHBsaXN0IFBVQkxJQyAiLS8vQXBwbGUvL0RURCBQTElTVCAxLjAvL0VOIiAiaHR0cDovL3d3dy5hcHBsZS5jb20vRFREcy9Qcm9wZXJ0eUxpc3QtMS4wLmR0ZCI+CjxwbGlzdCB2ZXJzaW9uPSIxLjAiPgo8ZGljdD4KCTxrZXk+UGF5bG9hZENvbnRlbnQ8L2tleT4KCTxhcnJheT4KCQk8ZGljdD4KCQkJPGtleT5BcHA8L2tleT4KCQkJPGRpY3Q+CgkJCQk8a2V5PklkZW50aWZpZXI8L2tleT4KCQkJCTxzdHJpbmc+Y2guYWJhY3VzLmFiYWNsb2NrLmNsaWVudDI8L3N0cmluZz4KCQkJCTxrZXk+T3B0aW9uczwva2V5PgoJCQkJPGRpY3Q+CgkJCQkJPGtleT5EaXNhYmxlQXV0b0xvY2s8L2tleT4KCQkJCQk8dHJ1ZS8+CgkJCQkJPGtleT5EaXNhYmxlU2xlZXBXYWtlQnV0dG9uPC9rZXk+CgkJCQkJPHRydWUvPgoJCQkJPC9kaWN0PgoJCQk8L2RpY3Q+CgkJCTxrZXk+UGF5bG9hZERpc3BsYXlOYW1lPC9rZXk+CgkJCTxzdHJpbmc+U2luZ2xlIEFwcCBNb2RlPC9zdHJpbmc+CgkJCTxrZXk+UGF5bG9hZElkZW50aWZpZXI8L2tleT4KCQkJPHN0cmluZz5jaC5hYmFjdXMuYWJhY2xvY2suY2xpZW50Mi5FRjIxQTc0OC1ENDFBLTQ0NEYtOUY3MS1GNUI1Q0RGRUMxOUMuY29tLmFwcGxlLmFwcC5sb2NrLjVDNjE1RjlBLTk5MDQtNEFERS04NjAxLTc4OTA5OTE3RkJERTwvc3RyaW5nPgoJCQk8a2V5PlBheWxvYWRPcmdhbml6YXRpb248L2tleT4KCQkJPHN0cmluZz48L3N0cmluZz4KCQkJPGtleT5QYXlsb2FkVHlwZTwva2V5PgoJCQk8c3RyaW5nPmNvbS5hcHBsZS5hcHAubG9jazwvc3RyaW5nPgoJCQk8a2V5PlBheWxvYWRVVUlEPC9rZXk+CgkJCTxzdHJpbmc+NUM2MTVGOUEtOTkwNC00QURFLTg2MDEtNzg5MDk5MTdGQkRFPC9zdHJpbmc+CgkJCTxrZXk+UGF5bG9hZFZlcnNpb248L2tleT4KCQkJPGludGVnZXI+MTwvaW50ZWdlcj4KCQk8L2RpY3Q+Cgk8L2FycmF5PgoJPGtleT5QYXlsb2FkRGlzcGxheU5hbWU8L2tleT4KCTxzdHJpbmc+U2luZ2xlIEFwcCBNb2RlIEFiYUNsb2NLIDI8L3N0cmluZz4KCTxrZXk+UGF5bG9hZElkZW50aWZpZXI8L2tleT4KCTxzdHJpbmc+Y2guYWJhY3VzLmFiYWNsb2NrLmNsaWVudDIuRUYyMUE3NDgtRDQxQS00NDRGLTlGNzEtRjVCNUNERkVDMTlDPC9zdHJpbmc+Cgk8a2V5PlBheWxvYWRPcmdhbml6YXRpb248L2tleT4KCTxzdHJpbmc+QWJhY3VzIFJlc2VhcmNoIEFHPC9zdHJpbmc+Cgk8a2V5PlBheWxvYWRTY29wZTwva2V5PgoJPHN0cmluZz5TeXN0ZW08L3N0cmluZz4KCTxrZXk+UGF5bG9hZFR5cGU8L2tleT4KCTxzdHJpbmc+Q29uZmlndXJhdGlvbjwvc3RyaW5nPgoJPGtleT5QYXlsb2FkVVVJRDwva2V5PgoJPHN0cmluZz5FRjIxQTc0OC1ENDFBLTQ0NEYtOUY3MS1GNUI1Q0RGRUMxOUM8L3N0cmluZz4KCTxrZXk+UGF5bG9hZFZlcnNpb248L2tleT4KCTxpbnRlZ2VyPjE8L2ludGVnZXI+CjwvZGljdD4KPC9wbGlzdD4K")

def install_vpp_abaclock_unmanaged(udid):
    data = '{"udid":"'+udid+'","request_type":"InstallApplication","itunes_store_id":1301278477,"options":{"purchase_method":1}}'
    response = requests.post('https://tobis.jumpingcrab.com/v1/commands', data=data, auth=('micromdm', 'secret'))
    print("install_vpp_abaclock_unmanaged", udid, response)

def managed_application_configuration(udid):
    data = '{"udid":"'+udid+'","request_type":"ManagedApplicationConfiguration","identifiers":["ch.abacus.abaclock.client2"]}'
    response = requests.post('https://tobis.jumpingcrab.com/v1/commands', data=data, auth=('micromdm', 'secret'))
    print("managed_application_configuration", udid, response)

def profile_list(udid):
    data = '{"udid":"'+udid+'","request_type":"ProfileList"}'
    response = requests.post('https://tobis.jumpingcrab.com/v1/commands', data=data, auth=('micromdm', 'secret'))
    print("profile_list", udid, response)

def managed_application_feedback(udid):
    data = '{"udid":"'+udid+'","request_type":"ManagedApplicationFeedback","identifiers":["ch.abacus.abaclock.client2"]}'
    response = requests.post('https://tobis.jumpingcrab.com/v1/commands', data=data, auth=('micromdm', 'secret'))
    print("managed_application_feedback", udid, response)


if __name__ == '__main__':
    app.run()